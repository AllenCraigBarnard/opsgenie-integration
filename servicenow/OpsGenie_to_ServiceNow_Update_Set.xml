<?xml version="1.0" encoding="UTF-8"?>
<unload unload_date="2016-06-13 10:11:38">
    <sys_remote_update_set action="INSERT_OR_UPDATE">
        <application display_value="Global">global</application>
        <application_name>Global</application_name>
        <application_scope>global</application_scope>
        <application_version/>
        <collisions/>
        <commit_date/>
        <deleted/>
        <description>OpsGenie to Service Now solution creates Incidents in ServiceNow from OpsGenie Alert</description>
        <inserted/>
        <name>OpsGenie to ServiceNow</name>
        <origin_sys_id/>
        <release_date/>
        <remote_sys_id>c0871e684f0862006f2853418110c709</remote_sys_id>
        <state>loaded</state>
        <summary/>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2016-06-13 10:11:37</sys_created_on>
        <sys_id>f1c756684f0862006f2853418110c70e</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2016-06-13 10:11:37</sys_updated_on>
        <update_set display_value=""/>
        <update_source display_value=""/>
        <updated/>
    </sys_remote_update_set>
    <sys_update_xml action="INSERT_OR_UPDATE">
        <action>INSERT_OR_UPDATE</action>
        <application display_value="Global">global</application>
        <category>customer</category>
        <comments/>
        <name>sys_app_application_3e5312284f0862006f2853418110c723</name>
        <payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update sys_domain="global" table="sys_app_application"><sys_app_application action="INSERT_OR_UPDATE"><active>true</active><category display_value="Custom Applications">e0355b31ef303000a61d5a3615c0fb78</category><description>Necessary tools to Setup create ServiceNow Incident from OpsGenie alerts</description><device_type>browser</device_type><hint>OpsGenie to ServiceNow Integration</hint><name/><order>100</order><roles>admin</roles><sys_class_name>sys_app_application</sys_class_name><sys_created_by>admin</sys_created_by><sys_created_on>2016-06-13 09:53:33</sys_created_on><sys_customer_update>true</sys_customer_update><sys_domain>global</sys_domain><sys_domain_path/><sys_id>3e5312284f0862006f2853418110c723</sys_id><sys_mod_count>0</sys_mod_count><sys_name>OpsGenie</sys_name><sys_overrides/><sys_package display_value="Global" source="global">global</sys_package><sys_policy/><sys_replace_on_upgrade>false</sys_replace_on_upgrade><sys_scope display_value="Global">global</sys_scope><sys_update_name>sys_app_application_3e5312284f0862006f2853418110c723</sys_update_name><sys_updated_by>admin</sys_updated_by><sys_updated_on>2016-06-13 09:53:33</sys_updated_on><title>OpsGenie</title><view_name/></sys_app_application></record_update>]]></payload>
        <remote_update_set display_value="OpsGenie to ServiceNow">f1c756684f0862006f2853418110c70e</remote_update_set>
        <replace_on_upgrade>false</replace_on_upgrade>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2016-06-13 10:11:37</sys_created_on>
        <sys_id>35c756684f0862006f2853418110c70e</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2016-06-13 10:11:37</sys_updated_on>
        <table/>
        <target_name>OpsGenie</target_name>
        <type>Application Menu</type>
        <update_domain>global</update_domain>
        <update_set display_value=""/>
        <view/>
    </sys_update_xml>
    <sys_update_xml action="INSERT_OR_UPDATE">
        <action>INSERT_OR_UPDATE</action>
        <application display_value="Global">global</application>
        <category>customer</category>
        <comments/>
        <name>sys_rest_message_1272dae44f0862006f2853418110c7a9</name>
        <payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update table="sys_rest_message"><sys_rest_message action="INSERT_OR_UPDATE"><access>package_private</access><authentication_type/><basic_auth_password/><basic_auth_profile/><basic_auth_user/><description>This endpoint retrieves whole alert data from OpsGenie</description><name>OpsGenie Alert API Endpoint</name><oauth2_profile/><protocol_name/><rest_endpoint>https://api.opsgenie.com/v1/json/alert?apiKey=${apiKey}&amp;id=${id}</rest_endpoint><sys_class_name>sys_rest_message</sys_class_name><sys_created_by>admin</sys_created_by><sys_created_on>2016-06-13 09:48:51</sys_created_on><sys_customer_update>true</sys_customer_update><sys_id>1272dae44f0862006f2853418110c7a9</sys_id><sys_mod_count>0</sys_mod_count><sys_name>OpsGenie Alert API Endpoint</sys_name><sys_package display_value="Global" source="global">global</sys_package><sys_policy/><sys_replace_on_upgrade>false</sys_replace_on_upgrade><sys_scope display_value="Global">global</sys_scope><sys_update_name>sys_rest_message_1272dae44f0862006f2853418110c7a9</sys_update_name><sys_updated_by>admin</sys_updated_by><sys_updated_on>2016-06-13 09:48:51</sys_updated_on><use_basic_auth>false</use_basic_auth><use_mutual_auth>false</use_mutual_auth></sys_rest_message></record_update>]]></payload>
        <remote_update_set display_value="OpsGenie to ServiceNow">f1c756684f0862006f2853418110c70e</remote_update_set>
        <replace_on_upgrade>false</replace_on_upgrade>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2016-06-13 10:11:37</sys_created_on>
        <sys_id>39c756684f0862006f2853418110c70e</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2016-06-13 10:11:37</sys_updated_on>
        <table/>
        <target_name>OpsGenie Alert API Endpoint</target_name>
        <type>REST Message</type>
        <update_domain>global</update_domain>
        <update_set display_value=""/>
        <view/>
    </sys_update_xml>
    <sys_update_xml action="INSERT_OR_UPDATE">
        <action>INSERT_OR_UPDATE</action>
        <application display_value="Global">global</application>
        <category>customer</category>
        <comments/>
        <name>sys_rest_message_fn_c09252284f0862006f2853418110c773</name>
        <payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update table="sys_rest_message_fn"><sys_rest_message_fn action="INSERT_OR_UPDATE"><authentication_type/><basic_auth_password/><basic_auth_profile/><basic_auth_user/><content/><function_name>delete</function_name><lock>false</lock><oauth2_profile/><protocol_name/><rest_endpoint>https://api.opsgenie.com/v1/json/alert?apiKey=${apiKey}&amp;id=${id}</rest_endpoint><rest_message display_value="OpsGenie Alert API Endpoint">1272dae44f0862006f2853418110c7a9</rest_message><sys_class_name>sys_rest_message_fn</sys_class_name><sys_created_by>admin</sys_created_by><sys_created_on>2016-06-13 09:48:51</sys_created_on><sys_customer_update>true</sys_customer_update><sys_id>c09252284f0862006f2853418110c773</sys_id><sys_mod_count>0</sys_mod_count><sys_name>delete</sys_name><sys_package display_value="Global" source="global">global</sys_package><sys_policy/><sys_replace_on_upgrade>false</sys_replace_on_upgrade><sys_scope display_value="Global">global</sys_scope><sys_update_name>sys_rest_message_fn_c09252284f0862006f2853418110c773</sys_update_name><sys_updated_by>admin</sys_updated_by><sys_updated_on>2016-06-13 09:48:51</sys_updated_on><use_basic_auth>false</use_basic_auth><use_mid_server/><use_mutual_auth>false</use_mutual_auth></sys_rest_message_fn></record_update>]]></payload>
        <remote_update_set display_value="OpsGenie to ServiceNow">f1c756684f0862006f2853418110c70e</remote_update_set>
        <replace_on_upgrade>false</replace_on_upgrade>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2016-06-13 10:11:37</sys_created_on>
        <sys_id>3dc756684f0862006f2853418110c70e</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2016-06-13 10:11:37</sys_updated_on>
        <table/>
        <target_name>delete</target_name>
        <type>HTTP Method</type>
        <update_domain>global</update_domain>
        <update_set display_value=""/>
        <view/>
    </sys_update_xml>
    <sys_update_xml action="INSERT_OR_UPDATE">
        <action>INSERT_OR_UPDATE</action>
        <application display_value="Global">global</application>
        <category>customer</category>
        <comments/>
        <name>sys_app_module_b2141a284f0862006f2853418110c7e3</name>
        <payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update sys_domain="global" table="sys_app_module"><sys_app_module action="INSERT_OR_UPDATE"><active>true</active><application display_value="OpsGenie">3e5312284f0862006f2853418110c723</application><assessment/><content_page/><device_type/><filter table="sys_rest_message">rest_endpointLIKEopsgenie^EQ<item endquery="false" field="rest_endpoint" goto="false" newquery="false" operator="LIKE" or="false" value="opsgenie"/><item endquery="true" field="" goto="false" newquery="false" operator="=" or="false" value=""/></filter><hint/><homepage/><image/><link_type>LIST</link_type><map_page/><mobile_title>REST Message</mobile_title><mobile_view_name>Mobile</mobile_view_name><name>sys_rest_message</name><order/><override_menu_roles>false</override_menu_roles><query/><report/><roles/><survey/><survey_overwrite>true</survey_overwrite><sys_class_name>sys_app_module</sys_class_name><sys_created_by>admin</sys_created_by><sys_created_on>2016-06-13 09:56:05</sys_created_on><sys_customer_update>true</sys_customer_update><sys_domain>global</sys_domain><sys_domain_path/><sys_id>b2141a284f0862006f2853418110c7e3</sys_id><sys_mod_count>0</sys_mod_count><sys_name>REST Message</sys_name><sys_overrides/><sys_package display_value="Global" source="global">global</sys_package><sys_policy/><sys_replace_on_upgrade>false</sys_replace_on_upgrade><sys_scope display_value="Global">global</sys_scope><sys_update_name>sys_app_module_b2141a284f0862006f2853418110c7e3</sys_update_name><sys_updated_by>admin</sys_updated_by><sys_updated_on>2016-06-13 09:56:05</sys_updated_on><timeline_page/><title>REST Message</title><uncancelable>false</uncancelable><view_name/><window_name/></sys_app_module></record_update>]]></payload>
        <remote_update_set display_value="OpsGenie to ServiceNow">f1c756684f0862006f2853418110c70e</remote_update_set>
        <replace_on_upgrade>false</replace_on_upgrade>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2016-06-13 10:11:37</sys_created_on>
        <sys_id>75c756684f0862006f2853418110c70e</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2016-06-13 10:11:37</sys_updated_on>
        <table>sys_rest_message</table>
        <target_name>REST Message</target_name>
        <type>Module</type>
        <update_domain>global</update_domain>
        <update_set display_value=""/>
        <view/>
    </sys_update_xml>
    <sys_update_xml action="INSERT_OR_UPDATE">
        <action>INSERT_OR_UPDATE</action>
        <application display_value="Global">global</application>
        <category>customer</category>
        <comments/>
        <name>sys_rest_message_fn_049252284f0862006f2853418110c772</name>
        <payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update table="sys_rest_message_fn"><sys_rest_message_fn action="INSERT_OR_UPDATE"><authentication_type/><basic_auth_password/><basic_auth_profile/><basic_auth_user/><content/><function_name>get</function_name><lock>false</lock><oauth2_profile/><protocol_name/><rest_endpoint>https://api.opsgenie.com/v1/json/alert?apiKey=${apiKey}&amp;id=${id}</rest_endpoint><rest_message display_value="OpsGenie Alert API Endpoint">1272dae44f0862006f2853418110c7a9</rest_message><sys_class_name>sys_rest_message_fn</sys_class_name><sys_created_by>admin</sys_created_by><sys_created_on>2016-06-13 09:48:51</sys_created_on><sys_customer_update>true</sys_customer_update><sys_id>049252284f0862006f2853418110c772</sys_id><sys_mod_count>0</sys_mod_count><sys_name>get</sys_name><sys_package display_value="Global" source="global">global</sys_package><sys_policy/><sys_replace_on_upgrade>false</sys_replace_on_upgrade><sys_scope display_value="Global">global</sys_scope><sys_update_name>sys_rest_message_fn_049252284f0862006f2853418110c772</sys_update_name><sys_updated_by>admin</sys_updated_by><sys_updated_on>2016-06-13 09:48:51</sys_updated_on><use_basic_auth>false</use_basic_auth><use_mid_server/><use_mutual_auth>false</use_mutual_auth></sys_rest_message_fn></record_update>]]></payload>
        <remote_update_set display_value="OpsGenie to ServiceNow">f1c756684f0862006f2853418110c70e</remote_update_set>
        <replace_on_upgrade>false</replace_on_upgrade>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2016-06-13 10:11:37</sys_created_on>
        <sys_id>79c756684f0862006f2853418110c70e</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2016-06-13 10:11:37</sys_updated_on>
        <table/>
        <target_name>get</target_name>
        <type>HTTP Method</type>
        <update_domain>global</update_domain>
        <update_set display_value=""/>
        <view/>
    </sys_update_xml>
    <sys_update_xml action="INSERT_OR_UPDATE">
        <action>INSERT_OR_UPDATE</action>
        <application display_value="Global">global</application>
        <category>customer</category>
        <comments/>
        <name>sys_script_include_8c1216284f0862006f2853418110c7a1</name>
        <payload>&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;record_update table="sys_script_include"&gt;&lt;sys_script_include action="INSERT_OR_UPDATE"&gt;&lt;access&gt;package_private&lt;/access&gt;&lt;active&gt;true&lt;/active&gt;&lt;api_name&gt;global.OpsGenie_Client&lt;/api_name&gt;&lt;client_callable&gt;false&lt;/client_callable&gt;&lt;description/&gt;&lt;name&gt;OpsGenie_Client&lt;/name&gt;&lt;script&gt;&lt;![CDATA[var OpsGenie_Client = Class.create();
            OpsGenie_Client.prototype = {
            initialize: function() {
            this.apiKey = "api-integration-key"; // paste the API key provided by OpsGenie here.
            },

            getAlertFromOpsGenie: function(alertId){
            var rest = new sn_ws.RESTMessageV2('OpsGenie Alert API Endpoint', 'get');
            rest.setStringParameter("apiKey", this.apiKey);
            rest.setStringParameter("id", alertId);
            gs.log("AlertId" + alertId);
            gs.log("Posting to " + rest.getEndpoint());
            var response = rest.execute();
            var responseBody = response.getBody();
            var httpStatus = response.getStatusCode();

            var responseLogMessage = "Response status:" + httpStatus + ", body:" + responseBody;
            if(httpStatus != 200){
            gs.logError(responseLogMessage);
            } else{
            gs.log(responseLogMessage);
            }
            return response;
            },

            type: 'OpsGenie_Client'
            };]]&gt;&lt;/script&gt;&lt;sys_class_name&gt;sys_script_include&lt;/sys_class_name&gt;&lt;sys_created_by&gt;admin&lt;/sys_created_by&gt;&lt;sys_created_on&gt;2016-06-13 09:47:48&lt;/sys_created_on&gt;&lt;sys_customer_update&gt;true&lt;/sys_customer_update&gt;&lt;sys_id&gt;8c1216284f0862006f2853418110c7a1&lt;/sys_id&gt;&lt;sys_mod_count&gt;0&lt;/sys_mod_count&gt;&lt;sys_name&gt;OpsGenie_Client&lt;/sys_name&gt;&lt;sys_package display_value="Global" source="global"&gt;global&lt;/sys_package&gt;&lt;sys_policy/&gt;&lt;sys_replace_on_upgrade&gt;false&lt;/sys_replace_on_upgrade&gt;&lt;sys_scope display_value="Global"&gt;global&lt;/sys_scope&gt;&lt;sys_update_name&gt;sys_script_include_8c1216284f0862006f2853418110c7a1&lt;/sys_update_name&gt;&lt;sys_updated_by&gt;admin&lt;/sys_updated_by&gt;&lt;sys_updated_on&gt;2016-06-13 09:47:48&lt;/sys_updated_on&gt;&lt;/sys_script_include&gt;&lt;/record_update&gt;</payload>
        <remote_update_set display_value="OpsGenie to ServiceNow">f1c756684f0862006f2853418110c70e</remote_update_set>
        <replace_on_upgrade>false</replace_on_upgrade>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2016-06-13 10:11:37</sys_created_on>
        <sys_id>7dc756684f0862006f2853418110c70e</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2016-06-13 10:11:37</sys_updated_on>
        <table/>
        <target_name>OpsGenie_Client</target_name>
        <type>Script Include</type>
        <update_domain>global</update_domain>
        <update_set display_value=""/>
        <view/>
    </sys_update_xml>
    <sys_update_xml action="INSERT_OR_UPDATE">
        <action>INSERT_OR_UPDATE</action>
        <application display_value="Global">global</application>
        <category>customer</category>
        <comments/>
        <name>sys_app_module_dbd39e284f0862006f2853418110c731</name>
        <payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update sys_domain="global" table="sys_app_module"><sys_app_module action="INSERT_OR_UPDATE"><active>true</active><application display_value="OpsGenie">3e5312284f0862006f2853418110c723</application><assessment/><content_page/><device_type/><filter table="sys_script_include">nameLIKEOpsGenie^EQ<item endquery="false" field="name" goto="false" newquery="false" operator="LIKE" or="false" value="OpsGenie"/><item endquery="true" field="" goto="false" newquery="false" operator="=" or="false" value=""/></filter><hint/><homepage/><image/><link_type>LIST</link_type><map_page/><mobile_title>Script Includes</mobile_title><mobile_view_name>Mobile</mobile_view_name><name>sys_script_include</name><order/><override_menu_roles>false</override_menu_roles><query/><report/><roles/><survey/><survey_overwrite>true</survey_overwrite><sys_class_name>sys_app_module</sys_class_name><sys_created_by>admin</sys_created_by><sys_created_on>2016-06-13 09:55:07</sys_created_on><sys_customer_update>true</sys_customer_update><sys_domain>global</sys_domain><sys_domain_path/><sys_id>dbd39e284f0862006f2853418110c731</sys_id><sys_mod_count>0</sys_mod_count><sys_name>Script Includes</sys_name><sys_overrides/><sys_package display_value="Global" source="global">global</sys_package><sys_policy/><sys_replace_on_upgrade>false</sys_replace_on_upgrade><sys_scope display_value="Global">global</sys_scope><sys_update_name>sys_app_module_dbd39e284f0862006f2853418110c731</sys_update_name><sys_updated_by>admin</sys_updated_by><sys_updated_on>2016-06-13 09:55:07</sys_updated_on><timeline_page/><title>Script Includes</title><uncancelable>false</uncancelable><view_name/><window_name/></sys_app_module></record_update>]]></payload>
        <remote_update_set display_value="OpsGenie to ServiceNow">f1c756684f0862006f2853418110c70e</remote_update_set>
        <replace_on_upgrade>false</replace_on_upgrade>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2016-06-13 10:11:37</sys_created_on>
        <sys_id>b5c756684f0862006f2853418110c70e</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2016-06-13 10:11:37</sys_updated_on>
        <table>sys_script_include</table>
        <target_name>Script Includes</target_name>
        <type>Module</type>
        <update_domain>global</update_domain>
        <update_set display_value=""/>
        <view/>
    </sys_update_xml>
    <sys_update_xml action="INSERT_OR_UPDATE">
        <action>INSERT_OR_UPDATE</action>
        <application display_value="Global">global</application>
        <category>customer</category>
        <comments/>
        <name>sys_rest_message_fn_489252284f0862006f2853418110c772</name>
        <payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update table="sys_rest_message_fn"><sys_rest_message_fn action="INSERT_OR_UPDATE"><authentication_type/><basic_auth_password/><basic_auth_profile/><basic_auth_user/><content/><function_name>post</function_name><lock>false</lock><oauth2_profile/><protocol_name/><rest_endpoint>https://api.opsgenie.com/v1/json/alert?apiKey=${apiKey}&amp;id=${id}</rest_endpoint><rest_message display_value="OpsGenie Alert API Endpoint">1272dae44f0862006f2853418110c7a9</rest_message><sys_class_name>sys_rest_message_fn</sys_class_name><sys_created_by>admin</sys_created_by><sys_created_on>2016-06-13 09:48:51</sys_created_on><sys_customer_update>true</sys_customer_update><sys_id>489252284f0862006f2853418110c772</sys_id><sys_mod_count>0</sys_mod_count><sys_name>post</sys_name><sys_package display_value="Global" source="global">global</sys_package><sys_policy/><sys_replace_on_upgrade>false</sys_replace_on_upgrade><sys_scope display_value="Global">global</sys_scope><sys_update_name>sys_rest_message_fn_489252284f0862006f2853418110c772</sys_update_name><sys_updated_by>admin</sys_updated_by><sys_updated_on>2016-06-13 09:48:51</sys_updated_on><use_basic_auth>false</use_basic_auth><use_mid_server/><use_mutual_auth>false</use_mutual_auth></sys_rest_message_fn></record_update>]]></payload>
        <remote_update_set display_value="OpsGenie to ServiceNow">f1c756684f0862006f2853418110c70e</remote_update_set>
        <replace_on_upgrade>false</replace_on_upgrade>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2016-06-13 10:11:37</sys_created_on>
        <sys_id>b9c756684f0862006f2853418110c70e</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2016-06-13 10:11:37</sys_updated_on>
        <table/>
        <target_name>post</target_name>
        <type>HTTP Method</type>
        <update_domain>global</update_domain>
        <update_set display_value=""/>
        <view/>
    </sys_update_xml>
    <sys_update_xml action="INSERT_OR_UPDATE">
        <action>INSERT_OR_UPDATE</action>
        <application display_value="Global">global</application>
        <category>customer</category>
        <comments/>
        <name>sys_ws_definition_6cc21a284f0862006f2853418110c7c8</name>
        <payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update table="sys_ws_definition"><sys_ws_definition action="INSERT_OR_UPDATE"><active>true</active><base_uri>/api/62940/opsgenie2sn</base_uri><consumes>application/json,application/xml,text/xml</consumes><consumes_customized>false</consumes_customized><default_version>No active default version</default_version><doc_link/><enforce_acl/><is_versioned>false</is_versioned><name>opsgenie2sn</name><namespace>62940</namespace><produces>application/json,application/xml,text/xml</produces><produces_customized>false</produces_customized><service_id>opsgenie2sn</service_id><short_description/><sys_class_name>sys_ws_definition</sys_class_name><sys_created_by>admin</sys_created_by><sys_created_on>2016-06-13 09:49:53</sys_created_on><sys_customer_update>true</sys_customer_update><sys_id>6cc21a284f0862006f2853418110c7c8</sys_id><sys_mod_count>0</sys_mod_count><sys_name>opsgenie2sn</sys_name><sys_package display_value="Global" source="global">global</sys_package><sys_policy/><sys_replace_on_upgrade>false</sys_replace_on_upgrade><sys_scope display_value="Global">global</sys_scope><sys_update_name>sys_ws_definition_6cc21a284f0862006f2853418110c7c8</sys_update_name><sys_updated_by>admin</sys_updated_by><sys_updated_on>2016-06-13 09:49:53</sys_updated_on></sys_ws_definition></record_update>]]></payload>
        <remote_update_set display_value="OpsGenie to ServiceNow">f1c756684f0862006f2853418110c70e</remote_update_set>
        <replace_on_upgrade>false</replace_on_upgrade>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2016-06-13 10:11:37</sys_created_on>
        <sys_id>bdc756684f0862006f2853418110c70e</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2016-06-13 10:11:37</sys_updated_on>
        <table/>
        <target_name>opsgenie2sn</target_name>
        <type>Scripted REST API</type>
        <update_domain>global</update_domain>
        <update_set display_value=""/>
        <view/>
    </sys_update_xml>
    <sys_update_xml action="INSERT_OR_UPDATE">
        <action>INSERT_OR_UPDATE</action>
        <application display_value="Global">global</application>
        <category>customer</category>
        <comments/>
        <name>sys_app_module_ec445e284f0862006f2853418110c74a</name>
        <payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update sys_domain="global" table="sys_app_module"><sys_app_module action="INSERT_OR_UPDATE"><active>true</active><application display_value="OpsGenie">3e5312284f0862006f2853418110c723</application><assessment/><content_page/><device_type/><filter table="sys_ws_definition">nameLIKEopsgenie^EQ<item endquery="false" field="name" goto="false" newquery="false" operator="LIKE" or="false" value="opsgenie"/><item endquery="true" field="" goto="false" newquery="false" operator="=" or="false" value=""/></filter><hint/><homepage/><image/><link_type>LIST</link_type><map_page/><mobile_title>Scripted REST API</mobile_title><mobile_view_name>Mobile</mobile_view_name><name>sys_ws_definition</name><order/><override_menu_roles>false</override_menu_roles><query/><report/><roles/><survey/><survey_overwrite>true</survey_overwrite><sys_class_name>sys_app_module</sys_class_name><sys_created_by>admin</sys_created_by><sys_created_on>2016-06-13 09:57:17</sys_created_on><sys_customer_update>true</sys_customer_update><sys_domain>global</sys_domain><sys_domain_path>/</sys_domain_path><sys_id>ec445e284f0862006f2853418110c74a</sys_id><sys_mod_count>1</sys_mod_count><sys_name>Scripted REST API</sys_name><sys_overrides/><sys_package display_value="Global" source="global">global</sys_package><sys_policy/><sys_replace_on_upgrade>false</sys_replace_on_upgrade><sys_scope display_value="Global">global</sys_scope><sys_update_name>sys_app_module_ec445e284f0862006f2853418110c74a</sys_update_name><sys_updated_by>admin</sys_updated_by><sys_updated_on>2016-06-13 09:58:37</sys_updated_on><timeline_page/><title>Scripted REST API</title><uncancelable>false</uncancelable><view_name/><window_name/></sys_app_module></record_update>]]></payload>
        <remote_update_set display_value="OpsGenie to ServiceNow">f1c756684f0862006f2853418110c70e</remote_update_set>
        <replace_on_upgrade>false</replace_on_upgrade>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2016-06-13 10:11:37</sys_created_on>
        <sys_id>f5c756684f0862006f2853418110c70e</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2016-06-13 10:11:37</sys_updated_on>
        <table>sys_ws_definition</table>
        <target_name>Scripted REST API</target_name>
        <type>Module</type>
        <update_domain>global</update_domain>
        <update_set display_value=""/>
        <view/>
    </sys_update_xml>
    <sys_update_xml action="INSERT_OR_UPDATE">
        <action>INSERT_OR_UPDATE</action>
        <application display_value="Global">global</application>
        <category>customer</category>
        <comments/>
        <name>sys_rest_message_fn_8c9252284f0862006f2853418110c772</name>
        <payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update table="sys_rest_message_fn"><sys_rest_message_fn action="INSERT_OR_UPDATE"><authentication_type/><basic_auth_password/><basic_auth_profile/><basic_auth_user/><content/><function_name>put</function_name><lock>false</lock><oauth2_profile/><protocol_name/><rest_endpoint>https://api.opsgenie.com/v1/json/alert?apiKey=${apiKey}&amp;id=${id}</rest_endpoint><rest_message display_value="OpsGenie Alert API Endpoint">1272dae44f0862006f2853418110c7a9</rest_message><sys_class_name>sys_rest_message_fn</sys_class_name><sys_created_by>admin</sys_created_by><sys_created_on>2016-06-13 09:48:51</sys_created_on><sys_customer_update>true</sys_customer_update><sys_id>8c9252284f0862006f2853418110c772</sys_id><sys_mod_count>0</sys_mod_count><sys_name>put</sys_name><sys_package display_value="Global" source="global">global</sys_package><sys_policy/><sys_replace_on_upgrade>false</sys_replace_on_upgrade><sys_scope display_value="Global">global</sys_scope><sys_update_name>sys_rest_message_fn_8c9252284f0862006f2853418110c772</sys_update_name><sys_updated_by>admin</sys_updated_by><sys_updated_on>2016-06-13 09:48:51</sys_updated_on><use_basic_auth>false</use_basic_auth><use_mid_server/><use_mutual_auth>false</use_mutual_auth></sys_rest_message_fn></record_update>]]></payload>
        <remote_update_set display_value="OpsGenie to ServiceNow">f1c756684f0862006f2853418110c70e</remote_update_set>
        <replace_on_upgrade>false</replace_on_upgrade>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2016-06-13 10:11:37</sys_created_on>
        <sys_id>f9c756684f0862006f2853418110c70e</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2016-06-13 10:11:37</sys_updated_on>
        <table/>
        <target_name>put</target_name>
        <type>HTTP Method</type>
        <update_domain>global</update_domain>
        <update_set display_value=""/>
        <view/>
    </sys_update_xml>
    <sys_update_xml action="INSERT_OR_UPDATE">
        <action>INSERT_OR_UPDATE</action>
        <application display_value="Global">global</application>
        <category>customer</category>
        <comments/>
        <name>sys_ws_operation_02d25a284f0862006f2853418110c788</name>
        <payload>&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;record_update table="sys_ws_operation"&gt;&lt;sys_ws_operation action="INSERT_OR_UPDATE"&gt;&lt;active&gt;true&lt;/active&gt;&lt;consumes&gt;application/json,application/xml,text/xml&lt;/consumes&gt;&lt;consumes_customized&gt;false&lt;/consumes_customized&gt;&lt;default_operation_uri/&gt;&lt;enforce_acl/&gt;&lt;http_method&gt;POST&lt;/http_method&gt;&lt;name&gt;createIncident&lt;/name&gt;&lt;operation_script&gt;&lt;![CDATA[(function process(/*RESTAPIRequest*/ request, /*RESTAPIResponse*/ response) {
            var body = request.body.data;

            if (body.source != null &amp;&amp; body.source.type.equals("ServiceNow")) {
            gs.log("OpsGenie alert is already created by a ServiceNow incident. Discarding!!!");
            return "will not process servicenow incident alert. discarded";
            }

            var client = new OpsGenie_Client();
            var ogResp = client.getAlertFromOpsGenie(body.alert.alertId);
            var responseBody = new JSON().decode(ogResp.getBody());

            if (ogResp.getStatusCode() == 400 || ogResp.getStatusCode() == 500){
            return new sn_ws_err.BadRequestError(responseBody.error);
            }

            var inc = new GlideRecord('incident');
            inc.short_description = responseBody.message;

            //	var teamName = responseBody.teams[0];
            //	var group = new GlideRecord('sys_user_group');
            //	group.addQuery('name', teamName);
            //	group.query();
            //	if (group.next()) {
            //		inc.assignment_group = group.sys_id.toString();
            //	} else {
            //		gs.log('Unable to find group with name: ' + teamName);
            //	}
            inc.insert();

            return "success";
            })(request, response);]]&gt;&lt;/operation_script&gt;&lt;operation_uri&gt;/api/62940/opsgenie2sn&lt;/operation_uri&gt;&lt;produces&gt;application/json,application/xml,text/xml&lt;/produces&gt;&lt;produces_customized&gt;false&lt;/produces_customized&gt;&lt;relative_path&gt;/&lt;/relative_path&gt;&lt;request_example/&gt;&lt;requires_acl_authorization&gt;false&lt;/requires_acl_authorization&gt;&lt;requires_authentication&gt;false&lt;/requires_authentication&gt;&lt;short_description/&gt;&lt;sys_class_name&gt;sys_ws_operation&lt;/sys_class_name&gt;&lt;sys_created_by&gt;admin&lt;/sys_created_by&gt;&lt;sys_created_on&gt;2016-06-13 09:50:57&lt;/sys_created_on&gt;&lt;sys_customer_update&gt;true&lt;/sys_customer_update&gt;&lt;sys_id&gt;02d25a284f0862006f2853418110c788&lt;/sys_id&gt;&lt;sys_mod_count&gt;0&lt;/sys_mod_count&gt;&lt;sys_name&gt;createIncident&lt;/sys_name&gt;&lt;sys_package display_value="Global" source="global"&gt;global&lt;/sys_package&gt;&lt;sys_policy/&gt;&lt;sys_replace_on_upgrade&gt;false&lt;/sys_replace_on_upgrade&gt;&lt;sys_scope display_value="Global"&gt;global&lt;/sys_scope&gt;&lt;sys_update_name&gt;sys_ws_operation_02d25a284f0862006f2853418110c788&lt;/sys_update_name&gt;&lt;sys_updated_by&gt;admin&lt;/sys_updated_by&gt;&lt;sys_updated_on&gt;2016-06-13 09:50:57&lt;/sys_updated_on&gt;&lt;web_service_definition display_value="opsgenie2sn"&gt;6cc21a284f0862006f2853418110c7c8&lt;/web_service_definition&gt;&lt;web_service_version/&gt;&lt;/sys_ws_operation&gt;&lt;/record_update&gt;</payload>
        <remote_update_set display_value="OpsGenie to ServiceNow">f1c756684f0862006f2853418110c70e</remote_update_set>
        <replace_on_upgrade>false</replace_on_upgrade>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2016-06-13 10:11:37</sys_created_on>
        <sys_id>fdc756684f0862006f2853418110c70e</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2016-06-13 10:11:37</sys_updated_on>
        <table/>
        <target_name>createIncident</target_name>
        <type>Scripted REST Resource</type>
        <update_domain>global</update_domain>
        <update_set display_value=""/>
        <view/>
    </sys_update_xml>
</unload>
